!!! Strict
%html{html_attrs}
  %head
    %title= "#{website.name} - #{h(yield(:title) || "Untitled")}"
    %meta{"http-equiv"=>"Content-Type", :content=>"text/html; charset=utf-8"}/
    %meta{:name => "description", :content => yield(:meta_description) || website.tagline }
    %meta{:name => "keywords", :content => yield(:meta_keywords) || website.default_tags }
    = stylesheet_link_tag 'reset', 'application', 'menu'
    %link{:href => "/stylesheets/#{h(website.theme || "blue")}.css?#{Time.now.to_i}", :media => 'screen', :rel => 'stylesheet theme', :type => 'text/css'}
    = javascript_include_tag 'jquery-1.3.2.min', 'search_box', 'admin'
    = yield(:head)
  %body
    - if admin?
      #admin-area
        .wrap
          %span.logout= link_to 'Logout', logout_path
          .menu
            %ul
              %li
                = link_to 'Home', root_path, :class => 'heading last'
              %li
                = link_to 'New', '#', :class => 'heading'
                %ul
                  %li
                    = link_to 'Article', new_article_path, :class => 'first'
                    = link_to 'Page', new_page_path
                    = link_to 'Project', new_project_path
                    = link_to 'Tag', new_tag_path, :class => 'last'
              %li
                = link_to 'Edit', '#', :class => 'heading'
                %ul
                  %li
                    = link_to 'Site', edit_site_path(website), :id => 'edit_site', :class => 'first last'
              %li
                = link_to 'View', '#', :class => 'heading'
                %ul
                  %li
                    = link_to 'Articles', articles_path, :class => 'first'
                    = link_to 'Comments', comments_path
                    = link_to 'Pages', pages_path
                    = link_to 'Projects', projects_path
                    = link_to 'Tags', tags_path, :class => 'last'
    #header
      .wrap
        #name
          %h1= link_to website.name, root_path
          %h2= website.tagline
        #navigation
          = link_to 'Home', root_path
          = link_to 'Projects', projects_path if Project.all.any?
          - for page in Page.released
            = link_to page.name, page_slug_path(page)
    #wrapper
      #container.wrap
        #main
          - flash.each do |name, msg|
            = content_tag :div, msg, :id => "flash_#{name}"
          - if show_title?
            %h1=h yield(:title)
            
          = yield
          
        #sidebar
          #search
            - form_tag search_path, :method => 'get' do
              = text_field_tag :q, ''
              = submit_tag "Go", :name => nil
            = link_to image_tag('feed.png', :title => 'Subscribe to this site'), feed_path
          #right
            = yield(:sidebar)
        .clear
    #footer
      .wrap
        #page-list
          %h4= 'Pages' if Page.released.any?
          %ul
          - for page in Page.released
            %li= link_to page.name, page_slug_path(page)
        #project-list
          %h4= 'Projects' if Project.all.any?
          %ul
          - for project in Project.all
            %li= link_to project.name, project
        #tag-list
          %h4= 'Tags' if Tag.all.any?
          %ul
          - for tag in Tag.all
            %li= link_to tag.name, tagged_articles_path(:tag => tag.name)
        #service-list
          %ul
            %li.flickr= link_to website.flickr_username, "http://flickr.com/photos/#{website.flickr_username}" if website.flickr_username
            %li.twitter= link_to website.twitter_username, "http://twitter.com/#{website.twitter_username}" if website.twitter_username
        .clear
        #copyright= "Copyright #{Time.now.year} &copy; #{website.owner_name}"
        #powered-by= "<em>Powered by</em> #{link_to 'rehash', 'http://github.com/webandy/rehash'}"